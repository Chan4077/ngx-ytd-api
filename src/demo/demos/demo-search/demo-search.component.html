<mat-toolbar color="primary" class="mat-elevation-z3">
	<button mat-icon-button (click)="shared.sidenav.toggle()">
		<mat-icon>menu</mat-icon>
	</button>
	Angular YouTube Data API
	<span fxFlex></span>
	<a routerLink="." mat-icon-button matTooltip="API Docs">
		<mat-icon>code</mat-icon>
	</a>
	<mat-chip-list>
		<mat-chip *ngIf="!shared.isProd" color="accent" (click)="shared.openDevConfig()">
			<mat-icon inline class="chip-icon">build</mat-icon>
			Developer Mode</mat-chip>
	</mat-chip-list>
	<app-version-picker></app-version-picker>
</mat-toolbar>
<div class="padding-percentage-container">
	<mat-card>
		<mat-card-title>YouTube Search</mat-card-title>
		<mat-card-content fxLayout="column">
			<form [formGroup]="searchForm" class="example-form" fxLayout="column" (keydown.enter)="submitForm()">
				<mat-form-field>
					<mat-label>Query</mat-label>
					<input matInput formControlName="query">
					<mat-error *ngIf="searchForm.get('query')?.hasError('required')">This is required.</mat-error>
				</mat-form-field>
				<br>
				<mat-checkbox formControlName="embeddable">Embeddable?</mat-checkbox>
				<br>
				<mat-form-field>
					<mat-label>Max results</mat-label>
					<input type="number" matInput formControlName="maxResults">
					<mat-error *ngIf="searchForm.get('maxResults')?.hasError('required')">This is required.</mat-error>
					<mat-error *ngIf="searchForm.get('maxResults')?.hasError('min') || searchForm.get('maxResults')?.hasError('max')">The range of allowed values are from 0 to 50.</mat-error>
				</mat-form-field>
			</form>
			<form [formGroup]="searchOptionsForm" class="example-form" fxLayout="column">
				<h3>Options</h3>
				<mat-slide-toggle formControlName="showJsonResult">Show JSON result?</mat-slide-toggle>
				<mat-slide-toggle formControlName="showDescription">Show description?</mat-slide-toggle>
			</form>
		</mat-card-content>
		<mat-card-actions align="end" class="example-card-actions">
			<button (click)="clearForm()" mat-stroked-button color="warn" [disabled]="searchForm.invalid">Clear form</button>
			<button (click)="searchVideos()" mat-stroked-button color="primary" [disabled]="searchForm.invalid">Search</button>
		</mat-card-actions>
	</mat-card>
	<hr>
	<div id="search-result" *ngIf="searchResult && !searchOptionsForm.get('showJsonResult').value">
		<div class="paginator">
			<button mat-stroked-button color="accent" (click)="searchVideos(searchResult?.prevPageToken)" *ngIf="searchResult?.prevPageToken">
				<mat-icon>keyboard_arrow_left</mat-icon> Previous page</button>
			<button mat-stroked-button color="accent" (click)="searchVideos(searchResult?.nextPageToken)" *ngIf="searchResult?.nextPageToken">Next page
				<mat-icon>keyboard_arrow_right</mat-icon>
			</button>
		</div>
		<div id="cards-container" fxLayout="row wrap">
			<mat-card *ngFor="let result of searchResult?.items" class="example-search-result-card">
				<mat-card-header>
					<mat-card-title>{{result?.snippet?.channelTitle}}</mat-card-title>
					<mat-card-subtitle>Published on {{result?.snippet?.publishedAt | date}}</mat-card-subtitle>
					<span fxFlex></span>
					<button mat-icon-button (click)="openCodeDialog(codeDialog)" matTooltip="Show JSON">
						<mat-icon>code</mat-icon>
					</button>
				</mat-card-header>
				<img mat-card-image [src]="result?.snippet?.thumbnails?.high?.url">
				<mat-card-title class="example-search-result-card-title">{{result?.snippet?.title}}</mat-card-title>
				<mat-card-content *ngIf="searchOptionsForm.get('showDescription').value">
					<strong>Description:</strong>
					<p [innerText]="result?.snippet?.description"></p>
				</mat-card-content>
				<mat-card-actions align="end">
					<a mat-stroked-button color="primary" href="https://youtu.be/{{result.id.videoId}}" *ngIf="result?.id?.videoId" target="_blank">
						View on YouTube
					</a>
				</mat-card-actions>
				<ng-template #codeDialog>
					<h2 matDialogTitle>Code Dialog</h2>
					<mat-dialog-content>
						<pre><code>{{result | json}}</code></pre>
					</mat-dialog-content>
					<mat-dialog-actions align="end">
						<button mat-button color="primary" (click)="closeCodeDialog()">Close</button>
					</mat-dialog-actions>
				</ng-template>
			</mat-card>
		</div>
		<div class="paginator">
			<button mat-stroked-button color="accent" (click)="searchVideos(searchResult.prevPageToken)" *ngIf="searchResult.prevPageToken">
				<mat-icon>keyboard_arrow_left</mat-icon> Previous page</button>
			<button mat-stroked-button color="accent" (click)="searchVideos(searchResult.nextPageToken)" *ngIf="searchResult.nextPageToken">Next page
				<mat-icon>keyboard_arrow_right</mat-icon>
			</button>
		</div>
	</div>
	<ng-container id="error-result" *ngIf="errorResult">
		<p>An error occured:</p>
		<pre><code>{{errorResult | json}}</code></pre>
	</ng-container>
	<ng-container *ngIf="searchOptionsForm.get('showJsonResult').value">
		<pre><code id="output">{{searchResult | json}}</code></pre>
	</ng-container>
</div>
